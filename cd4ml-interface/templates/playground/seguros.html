{% extends "base_playground.html" %}
{% block content %}
<div class="playground-container">
  <h2>APIs de Consulta de Seguros e Riscos</h2>
  <p class="api-description">
    Essa seção agrupa diversas APIs relacionadas à análise de risco socioambiental e fundiária, utilizadas na contratação de seguros agropecuários.
  </p>

  <h3>Exemplo: Consulta de Embargos Ambientais (IBAMA)</h3>
  <form method="POST">
    <label>CPF/CNPJ:</label>
    <input type="text" name="documento" required>

    <button type="submit">Consultar</button>
  </form>

  {% if resultado %}
    <h3>Resultado</h3>
    <pre>{{ resultado }}</pre>
  {% endif %}

  <hr>
  <h3>Documentação da API (IBAMA)</h3>
  <p><strong>Endpoint:</strong> <code>GET /files/&lt;ID&gt;?file=ibama-cne/&lt;cpf_cnpj&gt;/&lt;timestamp&gt;/ibama-certidao-embargo-&lt;cpf_cnpj&gt;.pdf</code></p>
  <p><strong>Método:</strong> <code>GET</code></p>
  <p><strong>Headers:</strong> <code>X-API-Key</code></p>

  <h4>Parâmetros</h4>
  <ul>
    <li><code>documento</code>: string - CPF ou CNPJ do produtor</li>
  </ul>

  <h4>API Key</h4>
  <p>Sua chave: <code>{{ api_key or 'SUA_CHAVE_AQUI' }}</code></p>

  <h4>Exemplo (Python)</h4>
  <pre><code>import requests

doc = "08002424913"
url = f"http://localhost:11001/files/63a20835b9325420f76fe393?file=ibama-cne/{doc}/1671563318308/ibama-certidao-embargo-{doc}.pdf"

response = requests.get(url, headers={"X-API-Key": "SUA_CHAVE_AQUI"})

with open("ibama_embargo.pdf", "wb") as f:
    f.write(response.content)</code></pre>
</div>
{% endblock %}